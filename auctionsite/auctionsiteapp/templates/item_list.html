{% extends 'base.html' %}

{% block content %}
<h1>{% block title %}{% endblock %}</h1>
{% block form %}{% endblock %}
<ul id="itemList">
</ul>
<script>
  const createListItem = (item, bids, expired=false) => {
    const {title, id} = item;
    const formattedDate = Date(item.endDate);
    let highestBid = 0
    for (let i =0; i < bids.length; i++) {
      const bid = bids[i];
      if (id === bid.item_id && bid.price > highestBid) {
        highestBid = bid.price
      }
    }
    return `<div class="col-md-3 text-center" id='item-list'>
                <li class="media" style="maxwidth=50px">
                  <img src="media/${item.picture}" alt="${title}" height="200" width="200"/>
                  <h2>${title}</h2>
                  <p>Description: ${item.description}</p>
                  <p>${expired ? 'Winning' : 'Current'} bid: Â£<span id="currentbid${id}">${highestBid}</span></p>
                  <p>Auction end: ${formattedDate}</p>
                  ${!expired ? `<form>
                    {% csrf_token %}
                      <label>Price</label>
                      <input id="price${id}" type="text" name="price" placeholder="0">
                  </form>
                  <button class="bidButton" id="bidButton${id}">Submit Bid</button>
                  <p id='error${id}'>&nbsp</p>` : ''}
                </li>
              </div>`;
  };
</script>
{% block scripts %}{% endblock %}
{% endblock %}

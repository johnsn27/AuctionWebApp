{% extends 'item_list.html' %}

{% block form %}
<div class="container">
  <div class="text-center">
    <h1>Search for an Item</h1>
    <form id='searchForm'>
      {% csrf_token %}
      <input name='query' type='text' placeholder='Search'/>
      <button id="searchBtn" type="button">
        Search
      </button>
    </form>
  </div>
</div>
{% endblock %}
{% block scripts %}
  <script>
    $(() => {
      $(document).on("keydown", "form", (event) => {
        return event.key != "Enter";
      });
      $.ajax({
        url: "{% url 'auctionsiteapp:itemsjson' %}",
        success: (data) => {
          console.log(data)
          $("#itemList").empty();
          for (let i=0; i<data.items.length; i++) {
            const item = data.items[i];
            $("#itemList").append(createListItem(item));
          }
        }
      });
      $("#searchBtn").click(() => {
        $.ajax({
          url: "{% url 'auctionsiteapp:itemsjson' %}",
          data: $("#searchForm").serializeArray(),
          success: (data) => {
            $("#itemList").empty();
            for (let i=0; i<data.items.length; i++) {
              const item = data.items[i];
              $("#itemList").append(createListItem(item));
            }
          }
        });
      });
    })
  </script>
{% endblock %}
